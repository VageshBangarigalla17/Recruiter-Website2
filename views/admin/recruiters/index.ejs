<%- include('../../partials/header') %>

<main style="zoom:80%" class="min-h-screen ">
  <div class="mx-auto max-w-7xl bg-white">
    
    <!-- Page Title and Add Button -->
    <div class="flex flex-col sm:flex-row items-center justify-between mb-10 space-y-4 sm:space-y-0">
      <h1 class="text-4xl font-extrabold text-gray-800 tracking-tight animate-fadeInDown">Manage Recruiters</h1>
      <a href="/admin/recruiters/new" 
         class="bg-blue-900 hover:bg-blue-800 text-white font-semibold py-3 px-6 rounded-xl shadow-lg hover:scale-105 transform transition duration-300 ease-in-out flex items-center space-x-2">
        <span class="text-xl"><i class="fa-solid fa-plus"></i></span>
        <span>Add Recruiter</span>
      </a>
    </div>

    <!-- Flash Messages -->
    <% if (success_msg && (typeof success_msg === 'string' && success_msg.trim() !== '' || Array.isArray(success_msg) && success_msg.length > 0)) { %>
      <div class="mb-6 bg-green-100 border border-green-300 text-green-800 px-4 py-3 rounded-xl animate-fadeIn">
        <%= Array.isArray(success_msg) ? success_msg.join('<br>') : success_msg %>
      </div>
    <% } %>
    <% if (error_msg && (typeof error_msg === 'string' && error_msg.trim() !== '' || Array.isArray(error_msg) && error_msg.length > 0)) { %>
      <div class="mb-6 bg-red-100 border border-red-300 text-red-800 px-4 py-3 rounded-xl animate-fadeIn">
        <%= Array.isArray(error_msg) ? error_msg.join('<br>') : error_msg %>
      </div>
    <% } %>

    <!-- Recruiters Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
      <% if (recruiters && recruiters.length > 0) { %>
        <% recruiters.forEach(function(rec, index) { %>
          <div class="bg-white rounded-2xl shadow-md hover:shadow-2xl hover:-translate-y-2 transform transition-all duration-500 ease-out animate-fadeInUp" style="animation-delay: <%= index * 0.1 %>s">
            <div class="p-6 flex flex-col items-center">
              
              <!-- Avatar with Border Glow -->
              <div class="relative w-28 h-28 rounded-full overflow-hidden border-4 border-blue-100 shadow-lg mb-4">
                <img
                  src="<%= rec.avatar || '/images/default-user.png' %>"
                  alt="<%= rec.username %>"
                  class="w-full h-full object-cover"
                  onerror="this.onerror=null;this.src='/images/default-user.png';"
                />
              </div>

              <!-- Recruiter Info -->
              <h2 class="text-xl font-bold text-gray-800 mb-1"><%= rec.username %></h2>
              <p class="text-sm text-gray-500 mb-1"><%= rec.email %></p>
              <p class="text-xs text-gray-400 mb-4">Joined: <%= new Date(rec.createdAt).toLocaleDateString('en-GB') %></p>

              <!-- Actions -->
              <div class="flex space-x-4">
                <a href="/admin/recruiters/<%= rec._id %>/edit" 
                   class="flex items-center text-blue-600 hover:text-blue-800 transition transform hover:scale-110">
                  <i class="fa-solid fa-pen-to-square mr-1"></i> Edit
                </a>
                <form action="/admin/recruiters/<%= rec._id %>?_method=DELETE" method="POST" 
                      onsubmit="return confirm('Are you sure you want to delete this recruiter?');">
                  <button type="submit" 
                          class="flex items-center text-red-600 hover:text-red-800 transition transform hover:scale-110">
                    <i class="fa-solid fa-trash mr-1"></i> Delete
                  </button>
                </form>
              </div>
            </div>
          </div>
        <% }); %>
      <% } else { %>
        <p class="text-center text-gray-500 col-span-full animate-fadeIn">No recruiters found. 
          <a href="/admin/recruiters/new" class="text-blue-600 underline">Add one now</a>.
        </p>
      <% } %>
    </div>
  </div>
</main>

<!-- Custom Animations -->
<style>
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes fadeInDown {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .animate-fadeIn { animation: fadeIn 0.6s ease-out forwards; }
  .animate-fadeInDown { animation: fadeInDown 0.6s ease-out forwards; }
  .animate-fadeInUp { animation: fadeInUp 0.6s ease-out forwards; }
</style>

<%- include('../../partials/footer') %>
