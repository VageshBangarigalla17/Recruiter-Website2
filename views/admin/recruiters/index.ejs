<%- include('../../partials/header') %>

<main style="zoom:80%" class="min-h-screen bg-gray-100 py-10 px-4">
  <div class=" mx-auto">
    <!-- Page Title and Add button -->
    <div class="flex items-center justify-between mb-8">
      <h1 class="text-3xl font-bold text-gray-800">Manage Recruiters</h1>
      <a href="/admin/recruiters/new" class="bg-blue-900 hover:bg-blue-800 text-white font-semibold py-2 rounded-lg transition duration-200 shadow flex items-center px-5">
        <span class="text-xl mr-2"><i class="fa-solid fa-plus"></i></span>
        <span class="font-medium">Add Recruiter</span>
      </a>
    </div>

        <!-- Flash Messages -->
    <% if (success_msg && (typeof success_msg === 'string' && success_msg.trim() !== '' || Array.isArray(success_msg) && success_msg.length > 0)) { %>
      <div class="mb-6 bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg">
        <%= Array.isArray(success_msg) ? success_msg.join('<br>') : success_msg %>
      </div>
    <% } %>
    <% if (error_msg && (typeof error_msg === 'string' && error_msg.trim() !== '' || Array.isArray(error_msg) && error_msg.length > 0)) { %>
      <div class="mb-6 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg">
        <%= Array.isArray(error_msg) ? error_msg.join('<br>') : error_msg %>
      </div>
    <% } %>

    <!-- Recruiters Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      <% if (recruiters && recruiters.length > 0) { %>
        <% recruiters.forEach(function(rec) { %>
          <div class="bg-white rounded-2xl shadow-md hover:shadow-lg transition">
            <div class="p-6 flex flex-col items-center">
              <!-- Avatar -->
              <div class="w-24 h-24 rounded-full overflow-hidden border-2 border-gray-200 mb-4">
                <img
                  src="<%= rec.avatar || '/images/default-user.png' %>"
                  alt="<%= rec.username %>"
                  class="w-full h-full object-cover"
                  onerror="this.onerror=null;this.src='/images/default-user.png';"
                />
              </div>

              <!-- Info -->
              <h2 class="text-xl font-semibold text-gray-800 mb-1"><%= rec.username %></h2>
              <p class="text-sm text-gray-500 mb-2"><%= rec.email %></p>
              <p class="text-xs text-gray-400 mb-4">createdAt: <%= new Date(rec.createdAt).toLocaleDateString('en-GB') %></p>

              <!-- Actions -->
              <div class="flex space-x-4">
                <a href="/admin/recruiters/<%= rec._id %>/edit" class="flex items-center text-blue-600 hover:text-blue-800 transition">
                  <span class="text-lg mr-1"><i class="fa-solid fa-pen-to-square"></i></span>
                  <span>Edit</span>
                </a>
                <form action="/admin/recruiters/<%= rec._id %>?_method=DELETE" method="POST" onsubmit="return confirm('Are you sure you want to delete this recruiter?');">
                  <button type="submit" class="flex items-center text-red-600 hover:text-red-800 transition">
                    <span class="text-lg mr-1"><i class="fa-solid fa-trash"></i></span>
                    <span>Delete</span>
                  </button>
                </form>
              </div>
            </div>
          </div>
        <% }); %>
      <% } else { %>
        <p class="text-center text-gray-500 col-span-full">No recruiters found. <a href="/admin/recruiters/new" class="text-blue-600 underline">Add one now</a>.</p>
      <% } %>
    </div>
  </div>
</main>

<%- include('../../partials/footer') %>
